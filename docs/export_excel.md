# Экспорт данных в Excel

Этот документ описывает файлы и процессы, связанные с функцией выгрузки прайс‑листа в формат Excel.

## Общая схема
1. На странице `Price/index.php` присутствует кнопка `<button class="btn" id="export-button">Экспорт в Excel</button>`.
2. В файле `Price/js/main.js` при загрузке страницы к этой кнопке привязывается обработчик `exportToExcel`.
3. Функция `exportToExcel` определена в `Price/js/export-excel.js`. Она берет данные из `window.__productsData`, формирует скрытую форму и отправляет её методом POST на `export.php`.
4. Скрипт `Price/export.php` получает JSON‑данные и с помощью библиотеки `phpoffice/phpspreadsheet` формирует Excel‑файл, который сразу отдается пользователю для скачивания.

## Связанные файлы
- **`Price/js/export-excel.js`** – формирует JSON и отправляет его на сервер.
- **`Price/js/main.js`** – добавляет обработчик клика на кнопку экспорта.
- **`Price/js/data-loader.js`** – загружает товары и сохраняет их в `window.__productsData`.
- **`Price/index.php`** – содержит HTML‑кнопку экспорта и подключает все скрипты.
- **`Price/export.php`** – серверная часть, создающая и отправляющая `.xlsx` файл. В каталоге также есть `export1.php` – предыдущая версия скрипта.

## Дальнейшее развитие
При изменении структуры данных или внешнего вида Excel‑файла редактируйте `export.php`. Если требуется изменить процесс вызова, обновите `export-excel.js` и соответствующие элементы в `index.php`.
